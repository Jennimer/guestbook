<!DOCTYPE html>
<html>

<head>
  <meta charset='UTF-8'>
  <title>Form page</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-aFq/bzH65dt+w6FI2ooMVUpc+21e0SRygnTpmBvdBgSdnuTN7QbdgL+OapgHtvPp" crossorigin="anonymous">



</head>

<body>
  <div>
    </form>
    <!-- action - define the URL where POST/GET request will be sent -->
    <form method="POST" id="messageform" action="/writemessage" onsubmit="return validateForm()">
      <div class="mb-3">
        <label for="FormControlInput1">Name</label class="form-label">
        <!-- Remark text field name-attribute -->
        <input type="text" class="form-control" id="name" placeholder="Name" name="name" />
      </div>

      <div class="mb-3">
        <label for="FormControlInput2">Country</label class="form-label">
        <!-- Remark text field name-attribute -->
        <input type="text" class="form-control" id="country" placeholder="Country" name="country" />
      </div>

      <div class="mb-3">
        <label for="FormControltextArea" class="form-label">Message</label>
        <textarea class="form-control" id="message" rows="3" type="text" placeholder="Message" name="message">
            </textarea>


      </div>
      <!-- Buttonin type = submit, which generates the sending -->
      <button type="submit" id="myButton" class="btn btn-primary">
        Submit
      </button>

    </form>
    <div class="alerts"></div>
    <div class="messages"></div>
  </div>
  <script src="https://code.jquery.com/jquery-3.6.4.js" integrity="sha256-a9jBBRygX1Bh5lt8GZjXDzyOB+bWve9EiO7tROUtj/E="
    crossorigin="anonymous"></script>
  <script>
  
    
    $(document).ready(function ()  {
      if (this.readyState == 4 && this.status == 200){
  var messagedata = require('./guestdata.json');}
  var messagearea = document.getElementById('messages');
  $.ajax({
  url: messagedata,
  method: 'GET',
  success: function(messagedata){
    console.log(messagedata);
  }
});

if (!data.success)

  //parse result in the table
  var results = '<table border="1px"' + 
  '<thead>' +
    '<tr>' +
    '<th>Name</th>' +
    '<th>Date</th>' +
    '<th>Country</th>' +
    '<th>Message</th>' +
    '</tr>' +
    '</thead>'
  for (var i = 0; i < messagedata.length; i++) {
    results +=
      '<tr>' +
      '<td>' + messagedata[i].name + '</td>' +
      '<td>' + messagedata[i].date + '</td>' +
      '<td>' + messagedata[i].country + '</td>' +
      '<td>' + messagedata[i].message + '</td>' +
      '</tr>' +
      '<tr></tr>' 
  }
  res.send(results);
});

    //Don't allow empty fields
    function validateForm() {
      var nameInput = document.forms["messageform"]["name"].value;
      var countryInput = document.forms["messageform"]["country"].value;
      var messageInput = document.forms["messageform"]["message"].value;

      if (nameInput == "" || countryInput == "" || messageInput == "") {

        alert("Please fill all the fields!");
        return false;
      }
      else {
        //Ajax
        $(document).ready(function () {
          $("form").submit(function (event) {
            var formData = {
              name: nameInput.val(),
              email: countryInput.val(),
              superheroAlias: messageInput.val(),
            };
            $.ajax({
              type: "GET",
              url: 'http://localhost:3000/writemessage',
              data: formData,
              dataType: "json",
              encode: true,
            }).done(function (data) {
              console.log(data);

              if (!data.success) {
                res.send(formData);
              }
            });
          });

        });
      }
    }

  </script>
</body>

</html>




